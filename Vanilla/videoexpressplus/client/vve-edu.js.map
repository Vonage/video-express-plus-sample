{"version":3,"file":"vve-edu.js","sources":["../node_modules/style-inject/dist/style-inject.es.js","../src/room-controller/services/credentialService.ts","../src/room-controller/utils/domWriter.ts","../src/room-controller/index.ts"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","'use strict';\n\nconst getCredentials = async (roomId: any, callbackUrl: string) => {\n  try {\n    const actionData = { action: 'getRoomData', roomId };\n    const response = await fetch(callbackUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(actionData),\n    });\n\n    return response.json();\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nconst getBreakOutRoomCredentials = async (callbackUrl: string) => {\n  const actionData = { action: 'getBreakOutRoomData' };\n\n  try {\n    const response = await fetch(callbackUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(actionData),\n    });\n    const data = await response.json();\n\n    return data;\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nexport { getCredentials, getBreakOutRoomCredentials };\n","'use strict';\n\nconst createElementDivWithId = (id: string) => {\n  const div = document.createElement('div');\n\n  div.setAttribute('id', id);\n\n  return div;\n};\n\nconst createElementDivWithClass = (className: string) => {\n  const div = document.createElement('div');\n\n  div.setAttribute('class', className);\n\n  return div;\n};\n\nexport { createElementDivWithId, createElementDivWithClass };\n","'use strict';\n\nimport '../styles/index.css';\n\nimport { ManagedLayoutOptions } from '@vonage/video-express/dist/utils/types';\nimport { getCredentials } from './services/credentialService';\nimport {\n  createElementDivWithClass,\n  createElementDivWithId\n} from './utils/domWriter';\n/**\n      The constructor takes one object, with the following properties:\n      \n      * participantId -- The unique ID assigned to the participant. This is the\n        `participantId` property of the Participant object returned by the server-side\n        `RoomManager.addParticipant()` and `RoomManager.getParticipant()` methods.\n      * callbackUrl -- On the server the developer will need to set up a callback URL.\n          See the docs for the server-side `RoomManager.handleClientEvent()` method.\n      * container -- The DOM element to contain the UI. (We will add more flexibility in later versions.)\n      * managedLayoutOptions -- These settings are used by all VideoExpress rooms instantiated\n      *   by the RoomManager.\n      * iceConfig -- This is used by all VideoExpress rooms instantiated by the RoomManager.\n      \n      The constructor throws an error if invalid properties are passed in.\n      Note that there is an `onError()` method of the `RoomController` instance. See\n      \"Asynchronous errors\" below.\n    */\nclass RoomController {\n  participantId: string;\n  callbackUrl: string;\n  proxyUrl?: string;\n  containerElement?: any;\n  managedLayoutOptions?: ManagedLayoutOptions;\n  logLabel = 'VideoExpressPlusClient:RoomController';\n  parentSession: any;\n  role?: string | null;\n  name: any;\n  waiting: any;\n  breakout: any;\n\n  videoSourceId: any;\n  audioSourceId: any;\n\n  prefix: string; // prefix for all containers\n\n\n  room: any;\n  brkroom: any;\n\n  addonsContainer: any;\n  roomContainer: any;\n  controlContainer: any;\n\n  // breakout elements\n  breakoutContainer: any;\n  addonsBreakoutButton: any;\n  breakoutMsg: any;\n\n  // waiting elements\n  waitingContainer: any;\n  addonsWaitingButton: any;\n\n  // whiteboard elements\n  whiteBoardContainer: any;\n  whiteBoardIframe: any;\n  addonsWhiteBoardButton: any;\n\n  //chat Container\n  chatContainer: any | undefined;\n  vveMicButton: any;\n  vveVideoButton: any;\n  handRaiseTemplate: any;\n  roomData: any;\n\n  breakoutButton: any;\n  publisherProperties: { height: string; width: string; audioSource: string | null; videoSource: string | null; };\n\n\n  constructor(\n    container: string,\n    participantId: string,\n    callbackUrl: string,\n    managedLayoutOptions?: ManagedLayoutOptions,\n  ) {\n    this.participantId = participantId;\n    this.callbackUrl = callbackUrl;\n    this.managedLayoutOptions = managedLayoutOptions;\n    this.containerElement = document.getElementById(container);\n    this.prefix ='vveplus';\n    this.publisherProperties = {\n      height: '100%',\n      width: '100%',\n      audioSource: localStorage.getItem('audioSourceId'),\n      videoSource: localStorage.getItem('videoSourceId'),\n    };\n    if (localStorage.getItem('backgroundBlur')) {\n      // this.publisherProperties.videoFilter = { type: 'backgroundBlur' };\n    }\n  }\n\n  async getWhiteBoardParticipantCredentials() {\n    try {\n      const response = await fetch('/api/whiteboard/sessions/join', {\n        method: 'POST',\n      });\n      const data = await response.json();\n\n      return data;\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  // const raiseHand = () => {\n  //   room.signal({\n  //     data: 'raise hand',\n  //     type: 'raise_hand',\n  //   });\n\n  //   raiseHandBtn.style.display = 'none';\n  //   lowerHandBtn.style.display = 'inline-block';\n  // };\n\n  // const lowerHand = () => {\n  //   room.signal({\n  //     data: 'lower hand',\n  //     type: 'lower_hand',\n  //   });\n  //   lowerHandBtn.style.display = 'none';\n  //   raiseHandBtn.style.display = 'inline-block';\n  // };\n\n  // raiseHandBtn.addEventListener('click', raiseHand, false);\n\n  // lowerHandBtn.addEventListener('click', lowerHand, false);\n\n  async getWhiteBoardAdminCredentials(boardName: string) {\n    try {\n      const response = await fetch('/api/whiteboard/sessions/create', {\n        method: 'POST',\n        body: JSON.stringify({\n          boardName: `${boardName}-board`,\n        }),\n      });\n      const data = await response.json();\n\n      return data;\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  async allowParticipant(e: any) {\n    console.log('Allow Participant Called', e);\n    const that = this as unknown as { participants: any };\n    const actionData = {\n      action: 'updateWaitingState',\n      name: e,\n      state: { state: true },\n    };\n\n    try {\n      const response = await fetch('/api/vve', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(actionData),\n      });\n      const data = await response.json();\n\n      that.participants = that.participants.filter(\n        (p: { name: any }) => p.name !== e,\n      );\n\n      return data;\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  async showWhiteBoardToNonHosts(e: any) {}\n\n  async dismissParticipant(e: any) {\n    console.log('Dismiss Participant Called', e);\n  }\n\n  goBack() {\n    this.hideAll();\n    this.showAddons();\n  }\n\n  async updateParticipantId(participantId: any, name: any) {\n    try {\n      const actionData = { action: 'updateParticipantId', name, participantId };\n      const response = await fetch('/api/vve/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(actionData),\n      });\n\n      return response;\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  async joinBreakOutRoom(roomId: any, name: any) {\n    try {\n      const actionData = {\n        action: 'joinBreakOutRoom',\n        name,\n        breakoutRoomId: roomId,\n      };\n      const response = await fetch('/api/vve/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(actionData),\n      });\n\n      return response;\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  async leaveRoom() {\n    await this.room.leave();\n    window.location.href = '/';\n  }\n\n  joinRoom(participantId: any, roomId: any, name: any) {\n    console.log('Join Room Called');\n    this.joinBreakOutRoom(roomId, name).then(res => console.log(res));\n  }\n\n  async createRoom(prefix: string='vveplus') {\n    let credential: any;\n\n    const actionData = { action: 'createBreakoutRoom' };\n\n    try {\n      const response = await fetch('/api/vve', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(actionData),\n      });\n\n      credential = await response.json();\n    } catch (err) {\n      console.log(err);\n\n      return;\n    }\n    const uint32 = window.crypto.getRandomValues(new Uint32Array(1))[0];\n  \n    const main = document.getElementById('main');\n    const container = document.createElement('div');\n    const containerId = `${prefix}-roomcontainer-${uint32.toString(16)}`;\n\n    container.setAttribute('id', containerId);\n    main?.appendChild(container);\n    const nroom = new VideoExpress.Room({\n      sessionId: credential?.break.sessionId,\n      apiKey: credential?.break.apiKey,\n      token: credential?.break.token,\n      roomContainer: containerId,\n    });\n\n    return nroom;\n  }\n\n  async joinMainRoom(main: any) {\n    \n    console.log('parent asked to join ', main);\n    const roomData = { main };\n\n    this.room = new VideoExpress.Room({\n      sessionId: roomData.main.sessionId,\n      apiKey: roomData.main.apiKey,\n      token: roomData.main.token,\n      participantName: this.name,\n      roomContainer: `${this.prefix}-roomcontainer`,\n    });\n\n    const { camera, screen } = this.room;\n\n    this.room.join({ publisherProperties: this.publisherProperties });\n\n    this.room.on('connected', () => {\n      console.log('room connected');\n      //this.vveMicButton.room = this.room;\n      console.log('audio enabled: ', camera.isAudioEnabled());\n      //this.vveMicButton.on = camera.isAudioEnabled();\n      console.log('video enabled: ', camera.isVideoEnabled());\n      ////this.vveVideoButton.room = this.room;\n      this.breakout.room = this.room;\n      const roomContainer = document.getElementById(this.room.roomContainer);\n\n      if (roomContainer != undefined) {\n        roomContainer.style.display = 'block';\n      }\n    });\n\n    this.room.on('signal:remove', async (signal: { isSentByMe: any }) => {\n      console.log('signal:remove: ', signal);\n      if (!signal.isSentByMe) {\n        // Code to leave room goes here\n        await this.leaveRoom();\n      }\n    });\n\n    this.room.on(\n      'signal:raise_hand',\n      (signal: { isSentByMe: any; from: { camera: { id: any } } }) => {\n        console.log('signal:raise_hand: ', signal);\n        const templateClone =\n          this.handRaiseTemplate.content.firstElementChild.cloneNode(true);\n        let selectedFeed;\n        let id;\n\n        if (!signal.isSentByMe) {\n          console.log('camera id: ', signal.from.camera.id);\n          id = `${signal.from.camera.id}-hand`;\n          selectedFeed = document.querySelector(\n            `#MP_${signal.from.camera.id}_default_controls`,\n          );\n        } else {\n          console.log('camera id: ', camera);\n          id = '#MP_camera_publisher_default_controls-hand';\n          selectedFeed = document.querySelector(\n            '#MP_camera_publisher_default_controls',\n          );\n        }\n        console.log('selected feed: ', selectedFeed);\n        templateClone.id = id;\n        if (selectedFeed != undefined) {\n          selectedFeed.appendChild(templateClone);\n        }\n      },\n    );\n\n    this.room.on(\n      'signal:lower_hand',\n      (signal: { isSentByMe: any; from: { camera: { id: any } } }) => {\n        console.log('signal:lower_hand: ', signal);\n        let id;\n\n        if (!signal.isSentByMe) {\n          console.log('camera id: ', signal.from.camera.id);\n          id = `${signal.from.camera.id}-hand`;\n        } else {\n          console.log('camera id: ', camera);\n          id = '#MP_camera_publisher_default_controls-hand';\n        }\n        if (document.getElementById(id) !== undefined) {\n          document.getElementById(id)?.remove();\n        }\n      },\n    );\n\n    this.room.on(\n      'signal:lower_hand_teacher',\n      (signal: { isSentByMe: any; from: { camera: { id: any } } }) => {\n        console.log('signal:lower_hand_teacher: ', signal);\n        let id;\n\n        if (!signal.isSentByMe) {\n          console.log('camera id: ', signal.from.camera.id);\n          id = '#MP_camera_publisher_default_controls-hand';\n          if (document.getElementById(id) !== undefined) {\n            document.getElementById(id)?.remove();\n          }\n          // lowerHand();\n        }\n      },\n    );\n  }\n\n  addWebComponent(componentName: string, container: any) {\n    const div = document.createElement('div');\n\n    div.setAttribute('id', componentName);\n    const vveComponent = document.createElement(`vve-${componentName}`);\n\n    div.append(vveComponent);\n    container.append(div);\n  }\n\n  addWaitingRoomBanner() {\n    const div = createElementDivWithId('waiting-banner');\n\n    document.body.appendChild(div);\n  }\n\n  toggleWaitingRoomBanner() {\n    const wb = document.getElementById('waiting-banner');\n\n    if (wb != undefined) {\n      if (wb.style.display !== 'block') {\n        wb.style.display = 'block';\n        wb.textContent = 'Please wait while host allow you to the meeting';\n      } else {\n        wb.style.display = 'none';\n      }\n    }\n  }\n\n  addWhiteBoardIframe() {\n    this.containerElement.insertAdjacentHTML(\n      'beforebegin',\n      '<div class=\"iframe-container\"><vwc-button appearance=\"filled\" connotation=\"accent\" id=\"go-back-whiteboard\" icon=\"arrow-left-line\" aria-label=\"Go Back\"></vwc-button><iframe id=\"whiteboard-iframe\"></iframe></div>',\n    );\n  }\n\n  toggleWhiteboardIframe() {\n    const we = this.whiteBoardContainer;\n\n    if (we !== undefined) {\n      if (we.style.display !== 'block') {\n        we.style.display = 'block';\n      } else {\n        we.style.display = 'none';\n      }\n    }\n  }\n\n  loadSkeleton(prefix: string='vveplus') {\n    this.containerElement.insertAdjacentHTML(\n      'afterbegin',\n      `<div id=\"main\"><div id=\"${prefix}-roomcontainer\" class=\"room\"></div></div><div id=\"${prefix}-control\"></div>`,\n    );\n  }\n\n  loadWebComponents(prefix: string='vveplus') {\n    this.roomContainer = document.getElementById(`${prefix}-roomcontainer`);\n    this.controlContainer = document.getElementById(`${prefix}-control`);\n\n    //add back button to\n    this.controlContainer.insertAdjacentHTML(\n      'afterbegin',\n      '<h3>Go Back</h3><vwc-icon-button id=\"close-addons\" icon=\"close\"></vwc-icon-button>',\n    );\n\n    // add breakout web component\n    this.addWebComponent('breakout', this.controlContainer);\n\n    // add waiting room component\n    this.addWebComponent('waiting', this.controlContainer);\n    this.addWaitingRoomBanner();\n\n    this.addWhiteBoardIframe();\n\n    // add text Chat Component\n    this.addWebComponent('text-chat', this.controlContainer);\n\n    this.breakout = document.querySelector('vve-breakout');\n    this.waiting = document.querySelector('vve-waiting');\n\n    //this.vveMicButton = document.querySelector('vve-mic-button');\n    //this.vveVideoButton = document.querySelector('vve-video-button');\n    this.handRaiseTemplate = document.querySelector('#hand-raise-template');\n  }\n\n  addMenuItem(title: string, subTitle: string, type: string, icon: string) {\n    const div = document.createElement('div');\n\n    div.setAttribute('id', `addon-${type}`);\n    div.setAttribute('class', 'item');\n    div.insertAdjacentHTML(\n      'afterbegin',\n      `<vwc-icon  type=\"${icon}\"></vwc-icon>\n    <div class=\"text\">\n      <span class=\"title\">${title}</span>\n      <span class=\"sub-title\">${subTitle}</span>\n    </div>`,\n    );\n\n    return div;\n  }\n\n  loadAddonsMenu() {\n    const divAddons = createElementDivWithId('addons');\n    const header = createElementDivWithClass('header');\n\n    header.insertAdjacentHTML(\n      'afterbegin',\n      '<h3>Add ons</h3><vwc-icon-button id=\"close-addons\" icon=\"close\"></vwc-icon-button>',\n    );\n\n    divAddons.appendChild(header);\n\n    const breakout = this.addMenuItem(\n      'Create Breakout',\n      'Get a quick pulse of the audience',\n      'breakout',\n      'apps-line',\n    );\n\n    divAddons.appendChild(breakout);\n\n    const waiting = this.addMenuItem(\n      'Waiting Room',\n      'See Who is waiting',\n      'waiting',\n      'group-permission-2-solid',\n    );\n\n    divAddons.appendChild(waiting);\n\n    const whiteboard = this.addMenuItem(\n      'Whiteboard',\n      'Brainstorm and Sketch Ideas',\n      'whiteboard',\n      'video-whiteboard-line',\n    );\n\n    divAddons.appendChild(whiteboard);\n\n    this.controlContainer?.appendChild(divAddons);\n  }\n\n  hideAll() {\n    this.breakoutContainer.style.display = 'none';\n    this.waitingContainer.style.display = 'none';\n    this.addonsContainer.style.display = 'none';\n    this.chatContainer.style.display = 'none';\n  }\n\n  showBreakout() {\n    this.breakoutContainer.style.display = 'block';\n  }\n\n  showWaiting() {\n    this.waitingContainer.style.display = 'block';\n  }\n\n  showAddons() {\n    this.addonsContainer.style.display = 'block';\n  }\n\n  hideWhiteBoard = () => {\n    this.roomContainer.style.width = 'calc(100vw - 480px)';\n    this.whiteBoardContainer.style.display = 'none';\n    this.addonsContainer.style.display = 'block';\n  };\n\n  async showWhiteBoard() {\n    if (this.role !== 'host') {\n      const participantCredentials =\n        await this.getWhiteBoardParticipantCredentials();\n      const participantToken = participantCredentials.participantsTokens[0];\n      const participantSessionId = participantCredentials.sessionId;\n      const url = `https://whiteboard.vonage.com/embed/${participantSessionId}?display_name=${this.name}&token=${participantToken}`;\n\n      this.whiteBoardIframe.src = url;\n      this.hideAll();\n      this.roomContainer.style.width = '200px';\n      this.toggleWhiteboardIframe();\n    } else {\n      // create view for teacher\n      const adminCredentials = await this.getWhiteBoardAdminCredentials(\n        this.name,\n      );\n\n      console.log(adminCredentials);\n      const url = `https://whiteboard.vonage.com/embed/${adminCredentials.sessionId}?display_name=${this.name}&token=${adminCredentials.ownerToken}`;\n\n      this.whiteBoardIframe.src = url;\n      this.hideAll();\n      this.roomContainer.style.width = '200px';\n      this.toggleWhiteboardIframe();\n    }\n  }\n\n  openBreakoutRoom() {\n    this.createRoom();\n  }\n\n  attachEvents() {\n    this.addonsBreakoutButton = document.getElementById('addon-breakout');\n    this.addonsWaitingButton = document.getElementById('addon-waiting');\n\n    this.addonsWhiteBoardButton = document.getElementById('addon-whiteboard');\n    this.breakoutContainer = document.getElementById('breakout');\n    this.breakoutMsg = document.getElementById('breakout-msg');\n    this.breakoutButton = document.getElementById('breakout-button');\n\n    this.waitingContainer = document.getElementById('waiting');\n\n    this.addonsContainer = document.getElementById('addons');\n    this.whiteBoardContainer = document.querySelector('.iframe-container');\n\n    this.whiteBoardIframe = document.getElementById('whiteboard-iframe');\n    this.chatContainer = document.getElementById('text-chat');\n\n    // this.breakoutButton.addEventListener('click', this.openBreakoutRoom, false);\n\n    this.addonsBreakoutButton.addEventListener('click', () => {\n      if (this.role === 'host') {\n        this.hideAll();\n        this.showBreakout();\n      }\n    });\n\n    this.addonsWaitingButton.addEventListener('click', () => {\n      if (this.role === 'host') {\n        this.hideAll();\n        this.showWaiting();\n      }\n    });\n\n    const gbw = document.getElementById('go-back-whiteboard');\n\n    if (gbw != undefined) {\n      gbw.addEventListener('click', () => {\n        this.hideAll();\n        this.hideWhiteBoard();\n        this.showAddons();\n      });\n    }\n\n    this.addonsWhiteBoardButton.addEventListener('click', () => {\n      this.hideAll();\n      this.showWhiteBoard();\n    });\n  }\n\n  async attachSessionEvents() {\n    /**\n     * Waiting Room Event Listener\n     */\n    this.parentSession.on(\n      'signal:waiting-participant',\n      (signal: { data: any }) => {\n        console.log('Waiting request recieved', signal.data);\n        if (this.role === 'host') {\n          const _participant = signal.data;\n\n          _participant.roomId = 'main';\n          this.waiting.participants = this.waiting.participants || [];\n          this.waiting.participants = [\n            ...this.waiting.participants,\n            _participant,\n          ];\n        }\n      },\n    );\n\n    this.parentSession.on(\n      'connectionDestroyed',\n      (participantLeft: { connection: { connectionId: any } }) => {\n        this.waiting.participants = this.waiting.participants.filter(\n          (participant: { id: any }) =>\n            participant.id !== participantLeft.connection.connectionId,\n        );\n      },\n    );\n\n    this.parentSession.on(\n      'signal:allow-participant',\n      async (signal: { data: { main: any } }) => {\n        console.log('Waiting request Approved', signal.data);\n        this.toggleWaitingRoomBanner();\n        if (this.role !== 'host') {\n          this.joinMainRoom(signal.data.main);\n        }\n      },\n    );\n\n    this.parentSession.on('signal:command', async (signal: { data: any }) => {\n      const roomData = signal.data;\n\n      await this.room.leave();\n\n      const rc = document.getElementById(`${this.prefix}-roomcontainer`);\n\n      if (rc != undefined) {\n        rc.innerHTML = '';\n      }\n\n      this.brkroom = new VideoExpress.Room({\n        sessionId: roomData.break.sessionId,\n        apiKey: roomData.break.apiKey,\n        token: roomData.break.token,\n        participantName: this.name,\n        roomContainer: `${this.prefix}-roomcontainer`,\n      });\n\n      this.brkroom.join({ publisherProperties: this.publisherProperties });\n\n      // Code to leave room goes here\n    });\n\n    this.parentSession.on('signal:close-all', async (signal: { data: any }) => {\n      console.log('Joining Main Room', signal.data);\n      await this.brkroom.leave();\n      const rc = document.getElementById(`${this.prefix}-roomcontainer`);\n\n      if (rc != undefined) {\n        rc.innerHTML = '';\n      }\n      const roomData = await getCredentials(signal.data, this.callbackUrl);\n\n      this.room = new VideoExpress.Room({\n        sessionId: roomData.main.sessionId,\n        apiKey: roomData.main.apiKey,\n        token: roomData.main.token,\n        participantName: this.name,\n        roomContainer: `${this.prefix}-roomcontainer`,\n      });\n\n      this.room.join({ publisherProperties: this.publisherProperties });\n    });\n\n    this.parentSession.on(\n      'signal:text_chat',\n      (event: { from: { id: any }; data: any }) => {\n        console.log(`Parent Signal sent from connection ${event.from.id}`);\n        console.log('payload', event.data);\n      },\n    );\n\n    if (this.role === 'host') {\n      this.room = new VideoExpress.Room({\n        sessionId: this.roomData.main.sessionId,\n        apiKey: this.roomData.main.apiKey,\n        token: this.roomData.main.token,\n        participantName: this.name,\n        roomContainer: `${this.prefix}-roomcontainer`,\n      });\n\n      const { camera, screen } = this.room;\n\n      this.room.join({ publisherProperties: this.publisherProperties });\n\n      this.room.on('connected', () => {\n        console.log('room connected');\n\n        //this.vveMicButton.room = this.room;\n        console.log('audio enabled: ', camera.isAudioEnabled());\n        //this.vveMicButton.on = camera.isAudioEnabled();\n        console.log('video enabled: ', camera.isVideoEnabled());\n        //this.vveVideoButton.room = this.room;\n\n        this.breakout.room = this.room;\n\n        const roomContainer = document.getElementById(this.room.roomContainer);\n\n        if (roomContainer != undefined) {\n          roomContainer.style.display = 'block';\n        }\n      });\n\n      this.room.on('signal:remove', async (signal: { isSentByMe: any }) => {\n        console.log('signal:remove: ', signal);\n        if (!signal.isSentByMe) {\n          // Code to leave room goes here\n          await this.leaveRoom();\n        }\n      });\n\n    } else {\n      this.toggleWaitingRoomBanner();\n    }\n  }\n\n  async initSession(roomId: string) {\n    this.roomData = await getCredentials(roomId, this.callbackUrl);\n\n    this.parentSession = OT.initSession(\n      this.roomData.parent.apiKey,\n      this.roomData.parent.sessionId,\n    );\n\n    this.parentSession.on(\n      'sessionConnected',\n      async (signal: { target: { connection: { connectionId: any } } }) => {\n        const data = await this.updateParticipantId(\n          signal.target.connection.connectionId,\n          this.name,\n        );\n\n        if (this.role !== 'host') {\n          console.log('Waiting request Sent');\n      \n          this.parentSession.signal({\n            data: {\n              id: signal.target.connection.connectionId,\n              name: this.name,\n            },\n            type: 'waiting-participant',\n          });\n        }\n      },\n    );\n\n    this.parentSession.connect(this.roomData.parent.token, (error: any) => {\n      if (error) {\n        console.log(error.message);\n      } else {\n        // If the connection is successful, publish to the session\n        console.log('Parent Session Connected!');\n        this.breakout.parent = this.parentSession;\n        this.waiting.parent = this.parentSession;\n\n        this.breakout.role = this.role;\n        this.breakout.createRoom = this.createRoom;\n        this.breakout.joinRoom = this.joinRoom.bind(this);\n\n        this.waiting.allowParticipant = this.allowParticipant;\n        this.waiting.dismissParticipant = this.dismissParticipant;\n        this.waiting.goBack = this.goBack.bind(this);\n\n        this.attachSessionEvents();\n      }\n    });\n  }\n\n  /**\n   * Driver method used to load required components and scripts in the order\n   */\n  async init() {\n    console.group(this.logLabel);\n    console.log('retrieving server config now..', this.callbackUrl);\n\n    const roomId = window.location.pathname.split('/')[2];\n    const params = new URLSearchParams(window.location.search);\n\n    this.name = params.get('name');\n    this.role = params.get('role');\n\n    this.loadSkeleton(this.prefix);\n\n    this.loadWebComponents(this.prefix);\n    \n    if (this.role === 'host') {\n      this.loadAddonsMenu();\n      this.attachEvents();\n    }\n    this.initSession(roomId);\n\n    console.log('%c Initialization Complete!', 'color: #bada55');\n    console.groupEnd();\n  }\n\n  /**\n      Register a function to handle asynchronous errors.\n      See \"Asynchronous errors\" below.\n    */\n  onError(): void {}\n\n  /**\n   * To use a proxy url to transport client events\n   * @param url\n   */\n  setProxyUrl(url: string): void {\n    this.proxyUrl = url;\n  }\n}\n\nexport default RoomController;\n"],"names":["css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","getCredentials","async","roomId","callbackUrl","fetch","method","headers","body","JSON","stringify","action","json","err","console","log","createElementDivWithId","id","div","setAttribute","logLabel","constructor","container","participantId","managedLayoutOptions","this","containerElement","getElementById","prefix","publisherProperties","height","width","audioSource","localStorage","getItem","videoSource","a","boardName","b","response","e","that","name","state","data","c","participants","filter","p","goBack","hideAll","showAddons","breakoutRoomId","room","leave","window","location","href","joinRoom","joinBreakOutRoom","then","res","credential","crypto","getRandomValues","Uint32Array","main","containerId","uint32","toString","VideoExpress","Room","sessionId","break","apiKey","token","roomContainer","roomData","participantName","camera","screen","join","on","isAudioEnabled","isVideoEnabled","breakout","display","signal","isSentByMe","leaveRoom","templateClone","handRaiseTemplate","content","firstElementChild","cloneNode","selectedFeed","querySelector","from","remove","addWebComponent","componentName","d","append","vveComponent","addWaitingRoomBanner","toggleWaitingRoomBanner","wb","textContent","addWhiteBoardIframe","insertAdjacentHTML","toggleWhiteboardIframe","whiteBoardContainer","we","loadSkeleton","loadWebComponents","controlContainer","waiting","addMenuItem","title","subTitle","icon","loadAddonsMenu","header","className","createElementDivWithClass","divAddons","whiteboard","breakoutContainer","waitingContainer","addonsContainer","chatContainer","showBreakout","showWaiting","hideWhiteBoard","role","getWhiteBoardParticipantCredentials","participantToken","participantCredentials","participantsTokens","url","whiteBoardIframe","src","getWhiteBoardAdminCredentials","adminCredentials","ownerToken","openBreakoutRoom","createRoom","attachEvents","addonsBreakoutButton","addonsWaitingButton","addonsWhiteBoardButton","breakoutMsg","breakoutButton","addEventListener","gbw","showWhiteBoard","parentSession","_participant","participantLeft","participant","connection","connectionId","joinMainRoom","rc","innerHTML","brkroom","event","OT","initSession","parent","updateParticipantId","target","connect","error","message","bind","allowParticipant","dismissParticipant","attachSessionEvents","group","pathname","split","params","URLSearchParams","search","get","groupEnd","onError","setProxyUrl","proxyUrl"],"mappings":"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"}