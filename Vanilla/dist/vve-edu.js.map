{"version":3,"names":["css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","getCredentials","async","roomId","callbackUrl","fetch","method","headers","body","JSON","stringify","action","json","err","console","log","createElementDivWithId","id","div","setAttribute","logLabel","constructor","props","this","participantId","managedLayoutOptions","containerElement","getElementById","container","prefix","publisherProperties","height","width","audioSource","localStorage","getItem","videoSource","videoFilter","boardName","isLocked","e","b","c","name","state","data","response","participants","that","filter","p","goBack","hideAll","showAddons","breakoutRoomId","room","leave","window","location","href","joinRoom","joinBreakOutRoom","then","res","a","credential","uint32","crypto","getRandomValues","Uint32Array","main","containerId","toString","VideoExpress","Room","sessionId","break","apiKey","applicationId","token","roomContainer","roomData","participantName","camera","screen","join","on","isAudioEnabled","isVideoEnabled","breakout","t","display","signal","isSentByMe","leaveRoom","n","handRaiseTemplate","content","firstElementChild","cloneNode","d","selectedFeed","querySelector","from","templateClone","remove","addWebComponent","componentName","append","vveComponent","addWaitingRoomBanner","toggleWaitingRoomBanner","wb","textContent","addWhiteBoardIframe","insertAdjacentHTML","toggleWhiteboardIframe","whiteBoardContainer","showWhiteBoardFlag","we","role","parentSession","showWhiteBoard","loadSkeleton","loadWebComponents","config","controlContainer","breakoutRoom","waitingRoom","waiting","whiteBoard","addMenuItem","title","subTitle","icon","i","loadAddonsMenu","divAddons","header","className","whiteboard","breakoutContainer","waitingContainer","addonsContainer","chatContainer","showBreakout","showWaiting","hideWhiteBoard","whiteBoardIframe","getWhiteBoardParticipantCredentials","participantToken","participantCredentials","participantsTokens","url","src","getWhiteBoardAdminCredentials","whiteboardOpts","adminCredentials","ownerToken","openBreakoutRoom","createRoom","attachEvents","addonsBreakoutButton","breakoutMsg","breakoutButton","addEventListener","addonsWaitingButton","addonsWhiteBoardButton","gbw","_participant","participantLeft","participant","connection","connectionId","joinMainRoom","parse","rc","innerHTML","brkroom","event","OT","initSession","parent","updateParticipantId","target","connect","error","message","bind","allowParticipant","dismissParticipant","attachSessionEvents","group","pathname","split","params","URLSearchParams","search","get","getBaseConfig","groupEnd","onError","setProxyUrl","proxyUrl","Object","defineProperties","__esModule","value","Symbol","toStringTag"],"sources":["../node_modules/style-inject/dist/style-inject.es.js","../src/room-controller/services/configurationService.ts","../src/room-controller/services/credentialService.ts","../src/room-controller/utils/domWriter.ts","../src/room-controller/index.ts"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","'use strict';\n\nconst getConfiguration = async (callbackUrl: string) => {\n  try {\n    const actionData = { action: 'getConfig' };\n    const response = await fetch(callbackUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(actionData),\n    });\n\n    return response.json();\n  } catch (err) {\n    console.log(err);\n  }\n};\nexport { getConfiguration };\n","'use strict';\n\nconst getCredentials = async (roomId: any, callbackUrl: string) => {\n  try {\n    const actionData = { action: 'getRoomData', roomId };\n    const response = await fetch(callbackUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(actionData),\n    });\n\n    return response.json();\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nconst getBreakOutRoomCredentials = async (callbackUrl: string) => {\n  const actionData = { action: 'getBreakOutRoomData' };\n\n  try {\n    const response = await fetch(callbackUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(actionData),\n    });\n    const data = await response.json();\n\n    return data;\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nconst whiteBoardCreate = async (\n  boardName: any,\n  isLocked: boolean,\n  callbackUrl: string,\n) => {\n  try {\n    const actionData = { action: 'whiteBoardCreate', boardName, isLocked };\n    const response = await fetch(callbackUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(actionData),\n    });\n\n    return response.json();\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nconst whiteBoardJoin = async (callbackUrl: string) => {\n  try {\n    const actionData = { action: 'whiteBoardJoin' };\n    const response = await fetch(callbackUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(actionData),\n    });\n\n    return response.json();\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nexport {\n  getCredentials,\n  getBreakOutRoomCredentials,\n  whiteBoardCreate,\n  whiteBoardJoin,\n};\n","'use strict';\n\nconst createElementDivWithId = (id: string) => {\n  const div = document.createElement('div');\n\n  div.setAttribute('id', id);\n\n  return div;\n};\n\nconst createElementDivWithClass = (className: string) => {\n  const div = document.createElement('div');\n\n  div.setAttribute('class', className);\n\n  return div;\n};\n\nexport { createElementDivWithId, createElementDivWithClass };\n","'use strict';\n\nimport '../styles/index.css';\n\nimport { ManagedLayoutOptions } from '@vonage/video-express/dist/utils/types';\nimport { getConfiguration } from './services/configurationService';\nimport {\n  getCredentials,\n  whiteBoardCreate,\n  whiteBoardJoin\n} from './services/credentialService';\nimport {\n  createElementDivWithClass,\n  createElementDivWithId\n} from './utils/domWriter';\n\nexport interface RoomControllerProps {\n  container: string;\n  participantId: string;\n  callbackUrl: string;\n  managedLayoutOptions?: ManagedLayoutOptions;\n}\n\nexport interface RoomConfiguration {\n  breakoutRoom: boolean;\n  breakoutOpts: any;\n  whiteBoard: boolean;\n  whiteboardOpts: any;\n  waitingRoom: boolean;\n  waitingOpts: any;\n}\n/**\n      The constructor takes one object, with the following properties:\n      \n      * participantId -- The unique ID assigned to the participant. This is the\n        `participantId` property of the Participant object returned by the server-side\n        `RoomManager.addParticipant()` and `RoomManager.getParticipant()` methods.\n      * callbackUrl -- On the server the developer will need to set up a callback URL.\n          See the docs for the server-side `RoomManager.handleClientEvent()` method.\n      * container -- The DOM element to contain the UI. (We will add more flexibility in later versions.)\n      * managedLayoutOptions -- These settings are used by all VideoExpress rooms instantiated\n      *   by the RoomManager.\n      * iceConfig -- This is used by all VideoExpress rooms instantiated by the RoomManager.\n      \n      The constructor throws an error if invalid properties are passed in.\n      Note that there is an `onError()` method of the `RoomController` instance. See\n      \"Asynchronous errors\" below.\n    */\nclass RoomController {\n  participantId: string;\n  callbackUrl: string;\n  proxyUrl?: string;\n  containerElement?: any;\n  managedLayoutOptions?: ManagedLayoutOptions;\n  logLabel = 'VideoExpressPlusClient:RoomController';\n  parentSession: any;\n  role?: string | null;\n  name: any;\n  waiting: any;\n  breakout: any;\n\n  videoSourceId: any;\n  audioSourceId: any;\n\n  prefix: string; // prefix for all containers\n\n  room: any;\n  brkroom: any;\n\n  addonsContainer: any;\n  roomContainer: any;\n  controlContainer: any;\n\n  // breakout elements\n  breakoutContainer: any;\n  addonsBreakoutButton: any;\n  breakoutMsg: any;\n\n  // waiting elements\n  waitingContainer: any;\n  addonsWaitingButton: any;\n\n  // whiteboard elements\n  whiteBoardContainer: any;\n  whiteBoardIframe: any;\n  addonsWhiteBoardButton: any;\n\n  //chat Container\n  chatContainer: any | undefined;\n  vveMicButton: any;\n  vveVideoButton: any;\n  handRaiseTemplate: any;\n  roomData: any;\n\n  breakoutButton: any;\n  publisherProperties: {\n    height: string;\n    width: string;\n    audioSource: string | null;\n    videoSource: string | null;\n  };\n\n  constructor(props: RoomControllerProps) {\n    this.participantId = props.participantId;\n    this.callbackUrl = props.callbackUrl;\n    this.managedLayoutOptions = props.managedLayoutOptions;\n    this.containerElement = document.getElementById(props.container);\n    this.prefix = 'vveplus';\n    this.publisherProperties = {\n      height: '100%',\n      width: '100%',\n      audioSource: localStorage.getItem('audioSourceId'),\n      videoSource: localStorage.getItem('videoSourceId'),\n    };\n    if (localStorage.getItem('backgroundBlur' === 'true')) {\n      this.publisherProperties.videoFilter = { type: 'backgroundBlur' };\n    }\n  }\n\n  async getBaseConfig() {\n    return await getConfiguration(this.callbackUrl);\n  }\n\n  async getWhiteBoardParticipantCredentials() {\n    return await whiteBoardJoin(this.callbackUrl);\n  }\n\n  // const raiseHand = () => {\n  //   room.signal({\n  //     data: 'raise hand',\n  //     type: 'raise_hand',\n  //   });\n\n  //   raiseHandBtn.style.display = 'none';\n  //   lowerHandBtn.style.display = 'inline-block';\n  // };\n\n  // const lowerHand = () => {\n  //   room.signal({\n  //     data: 'lower hand',\n  //     type: 'lower_hand',\n  //   });\n  //   lowerHandBtn.style.display = 'none';\n  //   raiseHandBtn.style.display = 'inline-block';\n  // };\n\n  // raiseHandBtn.addEventListener('click', raiseHand, false);\n\n  // lowerHandBtn.addEventListener('click', lowerHand, false);\n\n  async getWhiteBoardAdminCredentials(boardName: string, isLocked: boolean) {\n    return await whiteBoardCreate(boardName, isLocked, this.callbackUrl);\n  }\n\n  async allowParticipant(e: any) {\n    console.log('Allow Participant Called', e);\n    const that = this as unknown as { participants: any };\n    const actionData = {\n      action: 'updateWaitingState',\n      name: e,\n      state: { state: true },\n    };\n\n    try {\n      const response = await fetch('/api/vve', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(actionData),\n      });\n      const data = await response.json();\n\n      that.participants = that.participants.filter(\n        (p: { name: any }) => p.name !== e,\n      );\n\n      return data;\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  async showWhiteBoardToNonHosts(e: any) {}\n\n  async dismissParticipant(e: any) {\n    console.log('Dismiss Participant Called', e);\n  }\n\n  goBack() {\n    this.hideAll();\n    this.showAddons();\n  }\n\n  async updateParticipantId(participantId: any, name: any) {\n    try {\n      const actionData = { action: 'updateParticipantId', name, participantId };\n      const response = await fetch('/api/vve/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(actionData),\n      });\n\n      return response;\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  async joinBreakOutRoom(roomId: any, name: any) {\n    try {\n      const actionData = {\n        action: 'joinBreakOutRoom',\n        name,\n        breakoutRoomId: roomId,\n      };\n      const response = await fetch('/api/vve/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(actionData),\n      });\n\n      return response;\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  async leaveRoom() {\n    await this.room.leave();\n    window.location.href = '/';\n  }\n\n  joinRoom(participantId: any, roomId: any, name: any) {\n    console.log('Join Room Called');\n    this.joinBreakOutRoom(roomId, name).then(res => console.log(res));\n  }\n\n  async createRoom(prefix: string = 'vveplus') {\n    let credential: any;\n\n    const actionData = { action: 'createBreakoutRoom' };\n\n    try {\n      const response = await fetch('/api/vve', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(actionData),\n      });\n\n      credential = await response.json();\n    } catch (err) {\n      console.log(err);\n\n      return;\n    }\n    const uint32 = window.crypto.getRandomValues(new Uint32Array(1))[0];\n\n    const main = document.getElementById('main');\n    const container = document.createElement('div');\n    const containerId = `${prefix}-roomcontainer-${uint32.toString(16)}`;\n\n    container.setAttribute('id', containerId);\n    main?.appendChild(container);\n    const nroom = new VideoExpress.Room({\n      sessionId: credential?.break.sessionId,\n      apiKey: credential?.break.applicationId,\n      token: credential?.break.token,\n      roomContainer: containerId,\n    });\n\n    return nroom;\n  }\n\n  async joinMainRoom(main: any) {\n    console.log('parent asked to join ', main);\n    const roomData = { main };\n\n    this.room = new VideoExpress.Room({\n      sessionId: roomData.main.sessionId,\n      apiKey: roomData.main.applicationId,\n      token: roomData.main.token,\n      participantName: this.name,\n      roomContainer: `${this.prefix}-roomcontainer`,\n    });\n\n    const { camera, screen } = this.room;\n\n    this.room.join({ publisherProperties: this.publisherProperties });\n\n    this.room.on('connected', () => {\n      console.log('room connected');\n      //this.vveMicButton.room = this.room;\n      console.log('audio enabled: ', camera.isAudioEnabled());\n      //this.vveMicButton.on = camera.isAudioEnabled();\n      console.log('video enabled: ', camera.isVideoEnabled());\n      ////this.vveVideoButton.room = this.room;\n      if (this.breakout) {\n        this.breakout.room = this.room;\n      }\n\n      const roomContainer = document.getElementById(this.room.roomContainer);\n\n      if (roomContainer != undefined) {\n        roomContainer.style.display = 'block';\n      }\n    });\n\n    this.room.on('signal:remove', async (signal: { isSentByMe: any }) => {\n      console.log('signal:remove: ', signal);\n      if (!signal.isSentByMe) {\n        // Code to leave room goes here\n        await this.leaveRoom();\n      }\n    });\n\n    this.room.on(\n      'signal:raise_hand',\n      (signal: { isSentByMe: any; from: { camera: { id: any } } }) => {\n        console.log('signal:raise_hand: ', signal);\n        const templateClone =\n          this.handRaiseTemplate.content.firstElementChild.cloneNode(true);\n        let selectedFeed;\n        let id;\n\n        if (!signal.isSentByMe) {\n          console.log('camera id: ', signal.from.camera.id);\n          id = `${signal.from.camera.id}-hand`;\n          selectedFeed = document.querySelector(\n            `#MP_${signal.from.camera.id}_default_controls`,\n          );\n        } else {\n          console.log('camera id: ', camera);\n          id = '#MP_camera_publisher_default_controls-hand';\n          selectedFeed = document.querySelector(\n            '#MP_camera_publisher_default_controls',\n          );\n        }\n        console.log('selected feed: ', selectedFeed);\n        templateClone.id = id;\n        if (selectedFeed != undefined) {\n          selectedFeed.appendChild(templateClone);\n        }\n      },\n    );\n\n    this.room.on(\n      'signal:lower_hand',\n      (signal: { isSentByMe: any; from: { camera: { id: any } } }) => {\n        console.log('signal:lower_hand: ', signal);\n        let id;\n\n        if (!signal.isSentByMe) {\n          console.log('camera id: ', signal.from.camera.id);\n          id = `${signal.from.camera.id}-hand`;\n        } else {\n          console.log('camera id: ', camera);\n          id = '#MP_camera_publisher_default_controls-hand';\n        }\n        if (document.getElementById(id) !== undefined) {\n          document.getElementById(id)?.remove();\n        }\n      },\n    );\n\n    this.room.on(\n      'signal:lower_hand_teacher',\n      (signal: { isSentByMe: any; from: { camera: { id: any } } }) => {\n        console.log('signal:lower_hand_teacher: ', signal);\n        let id;\n\n        if (!signal.isSentByMe) {\n          console.log('camera id: ', signal.from.camera.id);\n          id = '#MP_camera_publisher_default_controls-hand';\n          if (document.getElementById(id) !== undefined) {\n            document.getElementById(id)?.remove();\n          }\n          // lowerHand();\n        }\n      },\n    );\n  }\n\n  addWebComponent(componentName: string, container: any) {\n    const div = document.createElement('div');\n\n    div.setAttribute('id', componentName);\n    const vveComponent = document.createElement(`vve-${componentName}`);\n\n    div.append(vveComponent);\n    container.append(div);\n  }\n\n  addWaitingRoomBanner() {\n    const div = createElementDivWithId('waiting-banner');\n\n    document.body.appendChild(div);\n  }\n\n  toggleWaitingRoomBanner() {\n    const wb = document.getElementById('waiting-banner');\n\n    if (wb != undefined) {\n      if (wb.style.display !== 'block') {\n        wb.style.display = 'block';\n        wb.textContent = 'Please wait while host allow you to the meeting';\n      } else {\n        wb.style.display = 'none';\n      }\n    }\n  }\n\n  addWhiteBoardIframe() {\n    this.containerElement.insertAdjacentHTML(\n      'beforebegin',\n      '<div class=\"iframe-container\"><vwc-button appearance=\"filled\" connotation=\"accent\" id=\"go-back-whiteboard\" icon=\"arrow-left-line\" aria-label=\"Go Back\"></vwc-button><iframe id=\"whiteboard-iframe\"></iframe></div>',\n    );\n  }\n\n  toggleWhiteboardIframe() {\n    const we = this.whiteBoardContainer;\n    let showWhiteBoardFlag = false;\n    if (we !== undefined) {\n      if (we.style.display !== 'block') {\n        we.style.display = 'block';\n        showWhiteBoardFlag = true;\n      } else {\n        we.style.display = 'none';\n        showWhiteBoardFlag = false;\n      }\n\n      if (this.role === 'host') {\n        this.parentSession.signal({\n          data: {\n            showWhiteBoard: showWhiteBoardFlag,\n          },\n          type: 'whiteboard',\n        });\n      }\n    }\n  }\n\n  loadSkeleton(prefix: string = 'vveplus') {\n    this.containerElement.insertAdjacentHTML(\n      'afterbegin',\n      `<div id=\"main\"><div id=\"${prefix}-roomcontainer\" class=\"room\"></div></div><div id=\"${prefix}-control\"></div>`,\n    );\n  }\n\n  loadWebComponents(prefix: string = 'vveplus', config: RoomConfiguration) {\n    this.roomContainer = document.getElementById(`${prefix}-roomcontainer`);\n    this.controlContainer = document.getElementById(`${prefix}-control`);\n\n    //add back button to\n    this.controlContainer.insertAdjacentHTML(\n      'afterbegin',\n      '<h3>Go Back</h3><vwc-icon-button id=\"close-addons\" icon=\"close\"></vwc-icon-button>',\n    );\n\n    // add breakout web component\n    if (config.breakoutRoom) {\n      this.addWebComponent('breakout', this.controlContainer);\n      this.breakout = document.querySelector('vve-breakout');\n    }\n\n    // add waiting room component\n    if (config.waitingRoom) {\n      this.addWebComponent('waiting', this.controlContainer);\n      this.addWaitingRoomBanner();\n      this.waiting = document.querySelector('vve-waiting');\n    }\n\n    if (config.whiteBoard) this.addWhiteBoardIframe();\n\n    // add text Chat Component\n    this.addWebComponent('text-chat', this.controlContainer);\n\n    //this.vveMicButton = document.querySelector('vve-mic-button');\n    //this.vveVideoButton = document.querySelector('vve-video-button');\n    this.handRaiseTemplate = document.querySelector('#hand-raise-template');\n  }\n\n  addMenuItem(title: string, subTitle: string, type: string, icon: string) {\n    const div = document.createElement('div');\n\n    div.setAttribute('id', `addon-${type}`);\n    div.setAttribute('class', 'item');\n    div.insertAdjacentHTML(\n      'afterbegin',\n      `<vwc-icon  type=\"${icon}\"></vwc-icon>\n    <div class=\"text\">\n      <span class=\"title\">${title}</span>\n      <span class=\"sub-title\">${subTitle}</span>\n    </div>`,\n    );\n\n    return div;\n  }\n\n  loadAddonsMenu(config: RoomConfiguration) {\n    const divAddons = createElementDivWithId('addons');\n    const header = createElementDivWithClass('header');\n\n    header.insertAdjacentHTML(\n      'afterbegin',\n      '<h3>Add ons</h3><vwc-icon-button id=\"close-addons\" icon=\"close\"></vwc-icon-button>',\n    );\n\n    divAddons.appendChild(header);\n\n    if (config.breakoutRoom) {\n      const breakout = this.addMenuItem(\n        'Create Breakout',\n        'Get a quick pulse of the audience',\n        'breakout',\n        'apps-line',\n      );\n      divAddons.appendChild(breakout);\n    }\n\n    if (config.waitingRoom) {\n      const waiting = this.addMenuItem(\n        'Waiting Room',\n        'See Who is waiting',\n        'waiting',\n        'group-permission-2-solid',\n      );\n      divAddons.appendChild(waiting);\n    }\n\n    if (config.whiteBoard) {\n      const whiteboard = this.addMenuItem(\n        'Whiteboard',\n        'Brainstorm and Sketch Ideas',\n        'whiteboard',\n        'video-whiteboard-line',\n      );\n\n      divAddons.appendChild(whiteboard);\n    }\n\n    this.controlContainer?.appendChild(divAddons);\n  }\n\n  hideAll() {\n    if (this.breakoutContainer) {\n      this.breakoutContainer.style.display = 'none';\n    }\n    if (this.waitingContainer) {\n      this.waitingContainer.style.display = 'none';\n    }\n\n    if (this.addonsContainer) {\n      this.addonsContainer.style.display = 'none';\n    }\n    if (this.chatContainer) {\n      this.chatContainer.style.display = 'none';\n    }\n  }\n\n  showBreakout() {\n    this.breakoutContainer.style.display = 'block';\n  }\n\n  showWaiting() {\n    this.waitingContainer.style.display = 'block';\n  }\n\n  showAddons() {\n    this.addonsContainer.style.display = 'block';\n  }\n\n  hideWhiteBoard = () => {\n    this.roomContainer.style.width = 'calc(100vw - 480px)';\n    this.whiteBoardContainer.style.display = 'none';\n    this.addonsContainer.style.display = 'block';\n  };\n\n  async showWhiteBoard(config: RoomConfiguration) {\n    this.whiteBoardIframe = document.getElementById('whiteboard-iframe');\n\n    if (this.role !== 'host') {\n      const participantCredentials =\n        await this.getWhiteBoardParticipantCredentials();\n      const participantToken = participantCredentials.participantsTokens[0];\n      const participantSessionId = participantCredentials.sessionId;\n      const url = `https://whiteboard.vonage.com/embed/${participantSessionId}?display_name=${this.name}&token=${participantToken}`;\n\n      this.whiteBoardIframe.src = url;\n      this.hideAll();\n      this.roomContainer.style.width = '200px';\n      this.toggleWhiteboardIframe();\n    } else {\n      // create view for teacher\n      const adminCredentials = await this.getWhiteBoardAdminCredentials(\n        this.name,\n        true === config?.whiteboardOpts?.isLocked,\n      );\n\n      console.log(adminCredentials);\n      const url = `https://whiteboard.vonage.com/embed/${adminCredentials.sessionId}?display_name=${this.name}&token=${adminCredentials.ownerToken}`;\n\n      this.whiteBoardIframe.src = url;\n      this.hideAll();\n      this.roomContainer.style.width = '200px';\n      this.toggleWhiteboardIframe();\n    }\n  }\n\n  openBreakoutRoom() {\n    this.createRoom();\n  }\n\n  attachEvents(config: RoomConfiguration) {\n    this.addonsContainer = document.getElementById('addons');\n\n    this.chatContainer = document.getElementById('text-chat');\n\n    if (config.breakoutRoom) {\n      this.addonsBreakoutButton = document.getElementById('addon-breakout');\n      this.breakoutContainer = document.getElementById('breakout');\n      this.breakoutMsg = document.getElementById('breakout-msg');\n      this.breakoutButton = document.getElementById('breakout-button');\n\n      this.addonsBreakoutButton.addEventListener('click', () => {\n        if (this.role === 'host') {\n          this.hideAll();\n          this.showBreakout();\n        }\n      });\n    }\n\n    if (config.waitingRoom) {\n      this.addonsWaitingButton = document.getElementById('addon-waiting');\n      this.waitingContainer = document.getElementById('waiting');\n      this.addonsWaitingButton.addEventListener('click', () => {\n        if (this.role === 'host') {\n          this.hideAll();\n          this.showWaiting();\n        }\n      });\n    }\n\n    if (config.whiteBoard) {\n      this.addonsWhiteBoardButton = document.getElementById('addon-whiteboard');\n      this.whiteBoardIframe = document.getElementById('whiteboard-iframe');\n      const gbw = document.getElementById('go-back-whiteboard');\n\n      if (gbw != undefined) {\n        gbw.addEventListener('click', () => {\n          this.hideAll();\n          this.hideWhiteBoard();\n          this.showAddons();\n        });\n      }\n\n      this.addonsWhiteBoardButton.addEventListener('click', () => {\n        this.hideAll();\n        this.showWhiteBoard(config);\n      });\n    }\n  }\n\n  async attachSessionEvents(config: RoomConfiguration) {\n    /**\n     * Waiting Room Event Listener\n     */\n    this.parentSession.on(\n      'signal:waiting-participant',\n      (signal: { data: any }) => {\n        console.log('Waiting request recieved', signal.data);\n        if (this.role === 'host' && config.waitingRoom) {\n          const _participant = signal.data;\n\n          _participant.roomId = 'main';\n          this.waiting.participants = this.waiting.participants || [];\n          this.waiting.participants = [\n            ...this.waiting.participants,\n            _participant,\n          ];\n        }\n      },\n    );\n\n    this.parentSession.on(\n      'connectionDestroyed',\n      (participantLeft: { connection: { connectionId: any } }) => {\n        this.waiting.participants = this.waiting.participants.filter(\n          (participant: { id: any }) =>\n            participant.id !== participantLeft.connection.connectionId,\n        );\n      },\n    );\n\n    if (config.waitingRoom) {\n      this.parentSession.on(\n        'signal:allow-participant',\n        async (signal: { data: string }) => {\n          console.log('Waiting request Approved', signal.data);\n          this.toggleWaitingRoomBanner();\n          if (this.role !== 'host') {\n            this.joinMainRoom(\n              (JSON.parse(signal.data) as { main: string }).main,\n            );\n          }\n        },\n      );\n    }\n\n    /**\n     * Toggle whiteboard for participant when host shows whiteboard\n     */\n    if (config.whiteBoard) {\n      this.parentSession.on(\n        'signal:whiteboard',\n        async (signal: { data: string }) => {\n          console.log('WhiteBoard request Recieved', signal.data);\n          if (this.role !== 'host') {\n            this.showWhiteBoard();\n          }\n        },\n      );\n    }\n\n    this.parentSession.on('signal:command', async (signal: { data: any }) => {\n      const roomData = JSON.parse(signal.data);\n\n      await this.room.leave();\n\n      const rc = document.getElementById(`${this.prefix}-roomcontainer`);\n\n      if (rc != undefined) {\n        rc.innerHTML = '';\n      }\n\n      this.brkroom = new VideoExpress.Room({\n        sessionId: roomData.break.sessionId,\n        apiKey: roomData.break.applicationId,\n        token: roomData.break.token,\n        participantName: this.name,\n        roomContainer: `${this.prefix}-roomcontainer`,\n      });\n\n      this.brkroom.join({ publisherProperties: this.publisherProperties });\n\n      // Code to leave room goes here\n    });\n\n    this.parentSession.on('signal:close-all', async (signal: { data: any }) => {\n      console.log('Joining Main Room', signal.data);\n      if(this.brkroom) {\n        await this.brkroom.leave();\n      }\n    \n      const rc = document.getElementById(`${this.prefix}-roomcontainer`);\n\n      if (rc != undefined) {\n        rc.innerHTML = '';\n      }\n      const roomData = await getCredentials(signal.data, this.callbackUrl);\n\n      this.room = new VideoExpress.Room({\n        sessionId: roomData.main.sessionId,\n        apiKey: roomData.main.applicationId,\n        token: roomData.main.token,\n        participantName: this.name,\n        roomContainer: `${this.prefix}-roomcontainer`,\n      });\n\n      this.room.join({ publisherProperties: this.publisherProperties });\n    });\n\n    this.parentSession.on(\n      'signal:text_chat',\n      (event: { from: { id: any }; data: any }) => {\n        console.log(`Parent Signal sent from connection ${event.from.id}`);\n        console.log('payload', event.data);\n      },\n    );\n    if (this.role !== 'host' && config.waitingRoom) {\n      this.toggleWaitingRoomBanner();\n    } else {\n      this.room = new VideoExpress.Room({\n        sessionId: this.roomData.main.sessionId,\n        apiKey: this.roomData.main.applicationId,\n        token: this.roomData.main.token,\n        participantName: this.name,\n        roomContainer: `${this.prefix}-roomcontainer`,\n      });\n\n      const { camera, screen } = this.room;\n\n      this.room.join({ publisherProperties: this.publisherProperties });\n\n      this.room.on('connected', () => {\n        console.log('room connected');\n\n        //this.vveMicButton.room = this.room;\n        console.log('audio enabled: ', camera.isAudioEnabled());\n        //this.vveMicButton.on = camera.isAudioEnabled();\n        console.log('video enabled: ', camera.isVideoEnabled());\n        //this.vveVideoButton.room = this.room;\n\n        if (this.breakout) {\n          this.breakout.room = this.room;\n        }\n\n        const roomContainer = document.getElementById(this.room.roomContainer);\n\n        if (roomContainer != undefined) {\n          roomContainer.style.display = 'block';\n        }\n      });\n\n      this.room.on('signal:remove', async (signal: { isSentByMe: any }) => {\n        console.log('signal:remove: ', signal);\n        if (!signal.isSentByMe) {\n          // Code to leave room goes here\n          await this.leaveRoom();\n        }\n      });\n    }\n  }\n\n  async initSession(roomId: string, config: RoomConfiguration) {\n    this.roomData = await getCredentials(roomId, this.callbackUrl);\n\n    this.parentSession = OT.initSession(\n      this.roomData.parent.applicationId,\n      this.roomData.parent.sessionId,\n    );\n\n    this.parentSession.on(\n      'sessionConnected',\n      async (signal: { target: { connection: { connectionId: any } } }) => {\n        const data = await this.updateParticipantId(\n          signal.target.connection.connectionId,\n          this.name,\n        );\n\n        if (this.role !== 'host' && config.waitingRoom) {\n          console.log('Waiting request Sent');\n\n          this.parentSession.signal({\n            data: {\n              id: signal.target.connection.connectionId,\n              name: this.name,\n            },\n            type: 'waiting-participant',\n          });\n        }\n      },\n    );\n\n    this.parentSession.connect(this.roomData.parent.token, (error: any) => {\n      if (error) {\n        console.log(error.message);\n      } else {\n        // If the connection is successful, publish to the session\n        console.log('Parent Session Connected!');\n\n        if (config.breakoutRoom) {\n          this.breakout.parent = this.parentSession;\n          this.breakout.role = this.role;\n          this.breakout.createRoom = this.createRoom;\n          this.breakout.joinRoom = this.joinRoom.bind(this);\n          this.breakout.goBack = this.goBack.bind(this);\n        }\n        if (config.waitingRoom) {\n          this.waiting.parent = this.parentSession;\n          this.waiting.allowParticipant = this.allowParticipant;\n          this.waiting.dismissParticipant = this.dismissParticipant;\n          this.waiting.goBack = this.goBack.bind(this);\n        }\n\n        this.attachSessionEvents(config);\n      }\n    });\n  }\n\n  /**\n   * Driver method used to load required components and scripts in the order\n   */\n  async init() {\n    console.group(this.logLabel);\n    console.log('retrieving server config now..', this.callbackUrl);\n\n    const roomId = window.location.pathname.split('/')[2];\n    const params = new URLSearchParams(window.location.search);\n\n    this.name = params.get('name');\n    this.role = params.get('role');\n\n    const config = await this.getBaseConfig();\n\n    this.loadSkeleton(this.prefix);\n\n    this.loadWebComponents(this.prefix, config);\n\n    this.whiteBoardContainer = document.querySelector('.iframe-container');\n\n    if (this.role === 'host') {\n      this.loadAddonsMenu(config);\n      this.attachEvents(config);\n    }\n    this.initSession(roomId, config);\n\n    console.log('%c Initialization Complete!', 'color: #bada55');\n    console.groupEnd();\n  }\n\n  /**\n      Register a function to handle asynchronous errors.\n      See \"Asynchronous errors\" below.\n    */\n  onError(): void {}\n\n  /**\n   * To use a proxy url to transport client events\n   * @param url\n   */\n  setProxyUrl(url: string): void {\n    this.proxyUrl = url;\n  }\n}\n\nexport default RoomController;\n"],"mappings":"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"}