{"version":3,"file":"vve-edu.js","sources":["../../node_modules/style-inject/dist/style-inject.es.js","../src/room-controller/services/credentialService.ts","../src/room-controller/utils/domWriter.ts","../src/room-controller/index.ts"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","'use strict';\n\nconst getCredentials = async (roomId: any, callbackUrl: string) => {\n  try {\n    const actionData = { action: 'getRoomData', roomId };\n    const response = await fetch(callbackUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(actionData),\n    });\n\n    return response.json();\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nconst getBreakOutRoomCredentials = async (callbackUrl: string) => {\n  const actionData = { action: 'getBreakOutRoomData' };\n\n  try {\n    const response = await fetch(callbackUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(actionData),\n    });\n    const data = await response.json();\n\n    return data;\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nconst whiteBoardCreate = async (boardName: any, callbackUrl: string) => {\n  try {\n    const actionData = { action: 'whiteBoardCreate', boardName };\n    const response = await fetch(callbackUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(actionData),\n    });\n\n    return response.json();\n  } catch (err) {\n    console.log(err);\n  }\n};\n\n\nconst whiteBoardJoin = async (callbackUrl: string) => {\n  try {\n    const actionData = { action: 'whiteBoardJoin' };\n    const response = await fetch(callbackUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(actionData),\n    });\n\n    return response.json();\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nexport { getCredentials, getBreakOutRoomCredentials, whiteBoardCreate, whiteBoardJoin };\n","'use strict';\n\nconst createElementDivWithId = (id: string) => {\n  const div = document.createElement('div');\n\n  div.setAttribute('id', id);\n\n  return div;\n};\n\nconst createElementDivWithClass = (className: string) => {\n  const div = document.createElement('div');\n\n  div.setAttribute('class', className);\n\n  return div;\n};\n\nexport { createElementDivWithId, createElementDivWithClass };\n","'use strict';\n\nimport '../styles/index.css';\n\nimport { ManagedLayoutOptions } from '@vonage/video-express/dist/utils/types';\nimport { getCredentials, whiteBoardCreate, whiteBoardJoin } from './services/credentialService';\nimport {\n  createElementDivWithClass,\n  createElementDivWithId\n} from './utils/domWriter';\n\nexport interface RoomControllerProps {\n  container: string;\n  participantId: string;\n  callbackUrl: string;\n  managedLayoutOptions?: ManagedLayoutOptions;\n}\n/**\n      The constructor takes one object, with the following properties:\n      \n      * participantId -- The unique ID assigned to the participant. This is the\n        `participantId` property of the Participant object returned by the server-side\n        `RoomManager.addParticipant()` and `RoomManager.getParticipant()` methods.\n      * callbackUrl -- On the server the developer will need to set up a callback URL.\n          See the docs for the server-side `RoomManager.handleClientEvent()` method.\n      * container -- The DOM element to contain the UI. (We will add more flexibility in later versions.)\n      * managedLayoutOptions -- These settings are used by all VideoExpress rooms instantiated\n      *   by the RoomManager.\n      * iceConfig -- This is used by all VideoExpress rooms instantiated by the RoomManager.\n      \n      The constructor throws an error if invalid properties are passed in.\n      Note that there is an `onError()` method of the `RoomController` instance. See\n      \"Asynchronous errors\" below.\n    */\nclass RoomController {\n  participantId: string;\n  callbackUrl: string;\n  proxyUrl?: string;\n  containerElement?: any;\n  managedLayoutOptions?: ManagedLayoutOptions;\n  logLabel = 'VideoExpressPlusClient:RoomController';\n  parentSession: any;\n  role?: string | null;\n  name: any;\n  waiting: any;\n  breakout: any;\n\n  videoSourceId: any;\n  audioSourceId: any;\n\n  prefix: string; // prefix for all containers\n\n  room: any;\n  brkroom: any;\n\n  addonsContainer: any;\n  roomContainer: any;\n  controlContainer: any;\n\n  // breakout elements\n  breakoutContainer: any;\n  addonsBreakoutButton: any;\n  breakoutMsg: any;\n\n  // waiting elements\n  waitingContainer: any;\n  addonsWaitingButton: any;\n\n  // whiteboard elements\n  whiteBoardContainer: any;\n  whiteBoardIframe: any;\n  addonsWhiteBoardButton: any;\n\n  //chat Container\n  chatContainer: any | undefined;\n  vveMicButton: any;\n  vveVideoButton: any;\n  handRaiseTemplate: any;\n  roomData: any;\n\n  breakoutButton: any;\n  publisherProperties: {\n    height: string;\n    width: string;\n    audioSource: string | null;\n    videoSource: string | null;\n  };\n\n  constructor(props: RoomControllerProps) {\n    this.participantId = props.participantId;\n    this.callbackUrl = props.callbackUrl;\n    this.managedLayoutOptions = props.managedLayoutOptions;\n    this.containerElement = document.getElementById(props.container);\n    this.prefix = 'vveplus';\n    this.publisherProperties = {\n      height: '100%',\n      width: '100%',\n      audioSource: localStorage.getItem('audioSourceId'),\n      videoSource: localStorage.getItem('videoSourceId'),\n    };\n    if (localStorage.getItem('backgroundBlur')) {\n      this.publisherProperties.videoFilter = { type: 'backgroundBlur' };\n    }\n  }\n\n  async getWhiteBoardParticipantCredentials() {\n    return await whiteBoardJoin( this.callbackUrl);\n  }\n\n  // const raiseHand = () => {\n  //   room.signal({\n  //     data: 'raise hand',\n  //     type: 'raise_hand',\n  //   });\n\n  //   raiseHandBtn.style.display = 'none';\n  //   lowerHandBtn.style.display = 'inline-block';\n  // };\n\n  // const lowerHand = () => {\n  //   room.signal({\n  //     data: 'lower hand',\n  //     type: 'lower_hand',\n  //   });\n  //   lowerHandBtn.style.display = 'none';\n  //   raiseHandBtn.style.display = 'inline-block';\n  // };\n\n  // raiseHandBtn.addEventListener('click', raiseHand, false);\n\n  // lowerHandBtn.addEventListener('click', lowerHand, false);\n\n  async getWhiteBoardAdminCredentials(boardName: string) {\n    return await whiteBoardCreate(boardName, this.callbackUrl);\n  }\n\n  async allowParticipant(e: any) {\n    console.log('Allow Participant Called', e);\n    const that = this as unknown as { participants: any };\n    const actionData = {\n      action: 'updateWaitingState',\n      name: e,\n      state: { state: true },\n    };\n\n    try {\n      const response = await fetch('/api/vve', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(actionData),\n      });\n      const data = await response.json();\n\n      that.participants = that.participants.filter(\n        (p: { name: any }) => p.name !== e,\n      );\n\n      return data;\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  async showWhiteBoardToNonHosts(e: any) {}\n\n  async dismissParticipant(e: any) {\n    console.log('Dismiss Participant Called', e);\n  }\n\n  goBack() {\n    this.hideAll();\n    this.showAddons();\n  }\n\n  async updateParticipantId(participantId: any, name: any) {\n    try {\n      const actionData = { action: 'updateParticipantId', name, participantId };\n      const response = await fetch('/api/vve/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(actionData),\n      });\n\n      return response;\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  async joinBreakOutRoom(roomId: any, name: any) {\n    try {\n      const actionData = {\n        action: 'joinBreakOutRoom',\n        name,\n        breakoutRoomId: roomId,\n      };\n      const response = await fetch('/api/vve/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(actionData),\n      });\n\n      return response;\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  async leaveRoom() {\n    await this.room.leave();\n    window.location.href = '/';\n  }\n\n  joinRoom(participantId: any, roomId: any, name: any) {\n    console.log('Join Room Called');\n    this.joinBreakOutRoom(roomId, name).then(res => console.log(res));\n  }\n\n  async createRoom(prefix: string = 'vveplus') {\n    let credential: any;\n\n    const actionData = { action: 'createBreakoutRoom' };\n\n    try {\n      const response = await fetch('/api/vve', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(actionData),\n      });\n\n      credential = await response.json();\n    } catch (err) {\n      console.log(err);\n\n      return;\n    }\n    const uint32 = window.crypto.getRandomValues(new Uint32Array(1))[0];\n\n    const main = document.getElementById('main');\n    const container = document.createElement('div');\n    const containerId = `${prefix}-roomcontainer-${uint32.toString(16)}`;\n\n    container.setAttribute('id', containerId);\n    main?.appendChild(container);\n    const nroom = new VideoExpress.Room({\n      sessionId: credential?.break.sessionId,\n      apiKey: credential?.break.applicationId,\n      token: credential?.break.token,\n      roomContainer: containerId,\n    });\n\n    return nroom;\n  }\n\n  async joinMainRoom(main: any) {\n    console.log('parent asked to join ', main);\n    const roomData = { main };\n\n    this.room = new VideoExpress.Room({\n      sessionId: roomData.main.sessionId,\n      apiKey: roomData.main.applicationId,\n      token: roomData.main.token,\n      participantName: this.name,\n      roomContainer: `${this.prefix}-roomcontainer`,\n    });\n\n    const { camera, screen } = this.room;\n\n    this.room.join({ publisherProperties: this.publisherProperties });\n\n    this.room.on('connected', () => {\n      console.log('room connected');\n      //this.vveMicButton.room = this.room;\n      console.log('audio enabled: ', camera.isAudioEnabled());\n      //this.vveMicButton.on = camera.isAudioEnabled();\n      console.log('video enabled: ', camera.isVideoEnabled());\n      ////this.vveVideoButton.room = this.room;\n      this.breakout.room = this.room;\n      const roomContainer = document.getElementById(this.room.roomContainer);\n\n      if (roomContainer != undefined) {\n        roomContainer.style.display = 'block';\n      }\n    });\n\n    this.room.on('signal:remove', async (signal: { isSentByMe: any }) => {\n      console.log('signal:remove: ', signal);\n      if (!signal.isSentByMe) {\n        // Code to leave room goes here\n        await this.leaveRoom();\n      }\n    });\n\n    this.room.on(\n      'signal:raise_hand',\n      (signal: { isSentByMe: any; from: { camera: { id: any } } }) => {\n        console.log('signal:raise_hand: ', signal);\n        const templateClone =\n          this.handRaiseTemplate.content.firstElementChild.cloneNode(true);\n        let selectedFeed;\n        let id;\n\n        if (!signal.isSentByMe) {\n          console.log('camera id: ', signal.from.camera.id);\n          id = `${signal.from.camera.id}-hand`;\n          selectedFeed = document.querySelector(\n            `#MP_${signal.from.camera.id}_default_controls`,\n          );\n        } else {\n          console.log('camera id: ', camera);\n          id = '#MP_camera_publisher_default_controls-hand';\n          selectedFeed = document.querySelector(\n            '#MP_camera_publisher_default_controls',\n          );\n        }\n        console.log('selected feed: ', selectedFeed);\n        templateClone.id = id;\n        if (selectedFeed != undefined) {\n          selectedFeed.appendChild(templateClone);\n        }\n      },\n    );\n\n    this.room.on(\n      'signal:lower_hand',\n      (signal: { isSentByMe: any; from: { camera: { id: any } } }) => {\n        console.log('signal:lower_hand: ', signal);\n        let id;\n\n        if (!signal.isSentByMe) {\n          console.log('camera id: ', signal.from.camera.id);\n          id = `${signal.from.camera.id}-hand`;\n        } else {\n          console.log('camera id: ', camera);\n          id = '#MP_camera_publisher_default_controls-hand';\n        }\n        if (document.getElementById(id) !== undefined) {\n          document.getElementById(id)?.remove();\n        }\n      },\n    );\n\n    this.room.on(\n      'signal:lower_hand_teacher',\n      (signal: { isSentByMe: any; from: { camera: { id: any } } }) => {\n        console.log('signal:lower_hand_teacher: ', signal);\n        let id;\n\n        if (!signal.isSentByMe) {\n          console.log('camera id: ', signal.from.camera.id);\n          id = '#MP_camera_publisher_default_controls-hand';\n          if (document.getElementById(id) !== undefined) {\n            document.getElementById(id)?.remove();\n          }\n          // lowerHand();\n        }\n      },\n    );\n  }\n\n  addWebComponent(componentName: string, container: any) {\n    const div = document.createElement('div');\n\n    div.setAttribute('id', componentName);\n    const vveComponent = document.createElement(`vve-${componentName}`);\n\n    div.append(vveComponent);\n    container.append(div);\n  }\n\n  addWaitingRoomBanner() {\n    const div = createElementDivWithId('waiting-banner');\n\n    document.body.appendChild(div);\n  }\n\n  toggleWaitingRoomBanner() {\n    const wb = document.getElementById('waiting-banner');\n\n    if (wb != undefined) {\n      if (wb.style.display !== 'block') {\n        wb.style.display = 'block';\n        wb.textContent = 'Please wait while host allow you to the meeting';\n      } else {\n        wb.style.display = 'none';\n      }\n    }\n  }\n\n  addWhiteBoardIframe() {\n    this.containerElement.insertAdjacentHTML(\n      'beforebegin',\n      '<div class=\"iframe-container\"><vwc-button appearance=\"filled\" connotation=\"accent\" id=\"go-back-whiteboard\" icon=\"arrow-left-line\" aria-label=\"Go Back\"></vwc-button><iframe id=\"whiteboard-iframe\"></iframe></div>',\n    );\n  }\n\n  toggleWhiteboardIframe() {\n    const we = this.whiteBoardContainer;\n    let showWhiteBoard = false;\n    if (we !== undefined) {\n      if (we.style.display !== 'block') {\n        we.style.display = 'block';\n        showWhiteBoard = true;\n      } else {\n        we.style.display = 'none';\n        showWhiteBoard = false;\n      }\n\n      if(this.role==='host') {\n      this.parentSession.signal({\n        data: {\n          showWhiteBoard: showWhiteBoard,\n        },\n        type: 'whiteboard',\n      });\n    }\n  }\n  }\n\n \n\n  loadSkeleton(prefix: string = 'vveplus') {\n    this.containerElement.insertAdjacentHTML(\n      'afterbegin',\n      `<div id=\"main\"><div id=\"${prefix}-roomcontainer\" class=\"room\"></div></div><div id=\"${prefix}-control\"></div>`,\n    );\n  }\n\n  loadWebComponents(prefix: string = 'vveplus') {\n    this.roomContainer = document.getElementById(`${prefix}-roomcontainer`);\n    this.controlContainer = document.getElementById(`${prefix}-control`);\n\n    //add back button to\n    this.controlContainer.insertAdjacentHTML(\n      'afterbegin',\n      '<h3>Go Back</h3><vwc-icon-button id=\"close-addons\" icon=\"close\"></vwc-icon-button>',\n    );\n\n    // add breakout web component\n    this.addWebComponent('breakout', this.controlContainer);\n\n    // add waiting room component\n    this.addWebComponent('waiting', this.controlContainer);\n    this.addWaitingRoomBanner();\n\n    this.addWhiteBoardIframe();\n\n    // add text Chat Component\n    this.addWebComponent('text-chat', this.controlContainer);\n\n    this.breakout = document.querySelector('vve-breakout');\n    this.waiting = document.querySelector('vve-waiting');\n\n    //this.vveMicButton = document.querySelector('vve-mic-button');\n    //this.vveVideoButton = document.querySelector('vve-video-button');\n    this.handRaiseTemplate = document.querySelector('#hand-raise-template');\n  }\n\n  addMenuItem(title: string, subTitle: string, type: string, icon: string) {\n    const div = document.createElement('div');\n\n    div.setAttribute('id', `addon-${type}`);\n    div.setAttribute('class', 'item');\n    div.insertAdjacentHTML(\n      'afterbegin',\n      `<vwc-icon  type=\"${icon}\"></vwc-icon>\n    <div class=\"text\">\n      <span class=\"title\">${title}</span>\n      <span class=\"sub-title\">${subTitle}</span>\n    </div>`,\n    );\n\n    return div;\n  }\n\n  loadAddonsMenu() {\n    const divAddons = createElementDivWithId('addons');\n    const header = createElementDivWithClass('header');\n\n    header.insertAdjacentHTML(\n      'afterbegin',\n      '<h3>Add ons</h3><vwc-icon-button id=\"close-addons\" icon=\"close\"></vwc-icon-button>',\n    );\n\n    divAddons.appendChild(header);\n\n    const breakout = this.addMenuItem(\n      'Create Breakout',\n      'Get a quick pulse of the audience',\n      'breakout',\n      'apps-line',\n    );\n\n    divAddons.appendChild(breakout);\n\n    const waiting = this.addMenuItem(\n      'Waiting Room',\n      'See Who is waiting',\n      'waiting',\n      'group-permission-2-solid',\n    );\n\n    divAddons.appendChild(waiting);\n\n    const whiteboard = this.addMenuItem(\n      'Whiteboard',\n      'Brainstorm and Sketch Ideas',\n      'whiteboard',\n      'video-whiteboard-line',\n    );\n\n    divAddons.appendChild(whiteboard);\n\n    this.controlContainer?.appendChild(divAddons);\n  }\n\n  hideAll() {\n    this.breakoutContainer.style.display = 'none';\n    this.waitingContainer.style.display = 'none';\n    this.addonsContainer.style.display = 'none';\n    this.chatContainer.style.display = 'none';\n  }\n\n  showBreakout() {\n    this.breakoutContainer.style.display = 'block';\n  }\n\n  showWaiting() {\n    this.waitingContainer.style.display = 'block';\n  }\n\n  showAddons() {\n    this.addonsContainer.style.display = 'block';\n  }\n\n  hideWhiteBoard = () => {\n    this.roomContainer.style.width = 'calc(100vw - 480px)';\n    this.whiteBoardContainer.style.display = 'none';\n    this.addonsContainer.style.display = 'block';\n  };\n\n  async showWhiteBoard() {\n    if (this.role !== 'host') {\n      const participantCredentials =\n        await this.getWhiteBoardParticipantCredentials();\n      const participantToken = participantCredentials.participantsTokens[0];\n      const participantSessionId = participantCredentials.sessionId;\n      const url = `https://whiteboard.vonage.com/embed/${participantSessionId}?display_name=${this.name}&token=${participantToken}`;\n\n      this.whiteBoardIframe.src = url;\n      this.hideAll();\n      this.roomContainer.style.width = '200px';\n      this.toggleWhiteboardIframe();\n    } else {\n      // create view for teacher\n      const adminCredentials = await this.getWhiteBoardAdminCredentials(\n        this.name,\n      );\n\n      console.log(adminCredentials);\n      const url = `https://whiteboard.vonage.com/embed/${adminCredentials.sessionId}?display_name=${this.name}&token=${adminCredentials.ownerToken}`;\n\n      this.whiteBoardIframe.src = url;\n      this.hideAll();\n      this.roomContainer.style.width = '200px';\n      this.toggleWhiteboardIframe();\n    }\n  }\n\n  openBreakoutRoom() {\n    this.createRoom();\n  }\n\n  attachEvents() {\n    this.addonsBreakoutButton = document.getElementById('addon-breakout');\n    this.addonsWaitingButton = document.getElementById('addon-waiting');\n\n    this.addonsWhiteBoardButton = document.getElementById('addon-whiteboard');\n    this.breakoutContainer = document.getElementById('breakout');\n    this.breakoutMsg = document.getElementById('breakout-msg');\n    this.breakoutButton = document.getElementById('breakout-button');\n\n    this.waitingContainer = document.getElementById('waiting');\n\n    this.addonsContainer = document.getElementById('addons');\n\n    this.whiteBoardIframe = document.getElementById('whiteboard-iframe');\n    this.chatContainer = document.getElementById('text-chat');\n\n    // this.breakoutButton.addEventListener('click', this.openBreakoutRoom, false);\n\n    this.addonsBreakoutButton.addEventListener('click', () => {\n      if (this.role === 'host') {\n        this.hideAll();\n        this.showBreakout();\n      }\n    });\n\n    this.addonsWaitingButton.addEventListener('click', () => {\n      if (this.role === 'host') {\n        this.hideAll();\n        this.showWaiting();\n      }\n    });\n\n    const gbw = document.getElementById('go-back-whiteboard');\n\n    if (gbw != undefined) {\n      gbw.addEventListener('click', () => {\n        this.hideAll();\n        this.hideWhiteBoard();\n        this.showAddons();\n      });\n    }\n\n    this.addonsWhiteBoardButton.addEventListener('click', () => {\n      this.hideAll();\n      this.showWhiteBoard();\n    });\n  }\n\n      async attachSessionEvents() {\n    /**\n     * Waiting Room Event Listener\n     */\n    this.parentSession.on(\n      'signal:waiting-participant',\n      (signal: { data: any }) => {\n        console.log('Waiting request recieved', signal.data);\n        if (this.role === 'host') {\n          const _participant = signal.data;\n\n          _participant.roomId = 'main';\n          this.waiting.participants = this.waiting.participants || [];\n          this.waiting.participants = [\n            ...this.waiting.participants,\n            _participant,\n          ];\n        }\n      },\n    );\n\n    this.parentSession.on(\n      'connectionDestroyed',\n      (participantLeft: { connection: { connectionId: any } }) => {\n        this.waiting.participants = this.waiting.participants.filter(\n          (participant: { id: any }) =>\n            participant.id !== participantLeft.connection.connectionId,\n        );\n      },\n    );\n\n    this.parentSession.on(\n      'signal:allow-participant',\n      async (signal: { data: string}) => {\n        console.log('Waiting request Approved', signal.data);\n        this.toggleWaitingRoomBanner();\n        if (this.role !== 'host') {\n          this.joinMainRoom((JSON.parse(signal.data) as {main:string}).main);\n        }\n      },\n    );\n\n    /**\n     * Toggle whiteboard for participant when host shows whiteboard\n     */\n    this.parentSession.on(\n      'signal:whiteboard',\n      async (signal: { data: string}) => {\n        console.log('WhiteBoard request Recieved', signal.data);\n        if (this.role !== 'host') {\n          this.showWhiteBoard();\n        }\n      },\n    );\n\n    this.parentSession.on('signal:command', async (signal: { data: any }) => {\n      const roomData = JSON.parse(signal.data);\n\n      await this.room.leave();\n\n      const rc = document.getElementById(`${this.prefix}-roomcontainer`);\n\n      if (rc != undefined) {\n        rc.innerHTML = '';\n      }\n\n      this.brkroom = new VideoExpress.Room({\n        sessionId: roomData.break.sessionId,\n        apiKey: roomData.break.applicationId,\n        token: roomData.break.token,\n        participantName: this.name,\n        roomContainer: `${this.prefix}-roomcontainer`,\n      });\n\n      this.brkroom.join({ publisherProperties: this.publisherProperties });\n\n      // Code to leave room goes here\n    });\n\n    this.parentSession.on('signal:close-all', async (signal: { data: any }) => {\n      console.log('Joining Main Room', signal.data);\n      await this.brkroom.leave();\n      const rc = document.getElementById(`${this.prefix}-roomcontainer`);\n\n      if (rc != undefined) {\n        rc.innerHTML = '';\n      }\n      const roomData = await getCredentials(signal.data, this.callbackUrl);\n\n      this.room = new VideoExpress.Room({\n        sessionId: roomData.main.sessionId,\n        apiKey: roomData.main.applicationId,\n        token: roomData.main.token,\n        participantName: this.name,\n        roomContainer: `${this.prefix}-roomcontainer`,\n      });\n\n      this.room.join({ publisherProperties: this.publisherProperties });\n    });\n\n    this.parentSession.on(\n      'signal:text_chat',\n      (event: { from: { id: any }; data: any }) => {\n        console.log(`Parent Signal sent from connection ${event.from.id}`);\n        console.log('payload', event.data);\n      },\n    );\n\n    if (this.role === 'host') {\n      this.room = new VideoExpress.Room({\n        sessionId: this.roomData.main.sessionId,\n        apiKey: this.roomData.main.applicationId,\n        token: this.roomData.main.token,\n        participantName: this.name,\n        roomContainer: `${this.prefix}-roomcontainer`,\n      });\n\n      const { camera, screen } = this.room;\n\n      this.room.join({ publisherProperties: this.publisherProperties });\n\n      this.room.on('connected', () => {\n        console.log('room connected');\n\n        //this.vveMicButton.room = this.room;\n        console.log('audio enabled: ', camera.isAudioEnabled());\n        //this.vveMicButton.on = camera.isAudioEnabled();\n        console.log('video enabled: ', camera.isVideoEnabled());\n        //this.vveVideoButton.room = this.room;\n\n        this.breakout.room = this.room;\n\n        const roomContainer = document.getElementById(this.room.roomContainer);\n\n        if (roomContainer != undefined) {\n          roomContainer.style.display = 'block';\n        }\n      });\n\n      this.room.on('signal:remove', async (signal: { isSentByMe: any }) => {\n        console.log('signal:remove: ', signal);\n        if (!signal.isSentByMe) {\n          // Code to leave room goes here\n          await this.leaveRoom();\n        }\n      });\n    } else {\n      this.toggleWaitingRoomBanner();\n    }\n  }\n\n  async initSession(roomId: string) {\n    this.roomData = await getCredentials(roomId, this.callbackUrl);\n\n    this.parentSession = OT.initSession(\n      this.roomData.parent.applicationId,\n      this.roomData.parent.sessionId,\n    );\n\n    this.parentSession.on(\n      'sessionConnected',\n      async (signal: { target: { connection: { connectionId: any } } }) => {\n        const data = await this.updateParticipantId(\n          signal.target.connection.connectionId,\n          this.name,\n        );\n\n        if (this.role !== 'host') {\n          console.log('Waiting request Sent');\n\n          this.parentSession.signal({\n            data: {\n              id: signal.target.connection.connectionId,\n              name: this.name,\n            },\n            type: 'waiting-participant',\n          });\n        }\n      },\n    );\n\n    this.parentSession.connect(this.roomData.parent.token, (error: any) => {\n      if (error) {\n        console.log(error.message);\n      } else {\n        // If the connection is successful, publish to the session\n        console.log('Parent Session Connected!');\n        this.breakout.parent = this.parentSession;\n        this.waiting.parent = this.parentSession;\n\n        this.breakout.role = this.role;\n        this.breakout.createRoom = this.createRoom;\n        this.breakout.joinRoom = this.joinRoom.bind(this);\n        this.breakout.goBack = this.goBack.bind(this);\n\n        this.waiting.allowParticipant = this.allowParticipant;\n        this.waiting.dismissParticipant = this.dismissParticipant;\n        this.waiting.goBack = this.goBack.bind(this);\n\n        this.attachSessionEvents();\n      }\n    });\n  }\n\n  /**\n   * Driver method used to load required components and scripts in the order\n   */\n  async init() {\n    console.group(this.logLabel);\n    console.log('retrieving server config now..', this.callbackUrl);\n\n    const roomId = window.location.pathname.split('/')[2];\n    const params = new URLSearchParams(window.location.search);\n\n    this.name = params.get('name');\n    this.role = params.get('role');\n\n    this.loadSkeleton(this.prefix);\n\n    this.loadWebComponents(this.prefix);\n\n    this.whiteBoardContainer = document.querySelector('.iframe-container');\n\n    if (this.role === 'host') {\n      this.loadAddonsMenu();\n      this.attachEvents();\n    }\n    this.initSession(roomId);\n\n    console.log('%c Initialization Complete!', 'color: #bada55');\n    console.groupEnd();\n  }\n\n  /**\n      Register a function to handle asynchronous errors.\n      See \"Asynchronous errors\" below.\n    */\n  onError(): void {}\n\n  /**\n   * To use a proxy url to transport client events\n   * @param url\n   */\n  setProxyUrl(url: string): void {\n    this.proxyUrl = url;\n  }\n}\n\nexport default RoomController;\n\n"],"names":["css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","getCredentials","async","roomId","callbackUrl","fetch","method","headers","body","JSON","stringify","action","json","err","console","log","createElementDivWithId","id","div","setAttribute","logLabel","constructor","props","this","participantId","managedLayoutOptions","containerElement","getElementById","container","prefix","publisherProperties","height","width","audioSource","localStorage","getItem","videoSource","videoFilter","whiteBoardJoin","boardName","whiteBoardCreate","e","that","c","name","state","data","participants","filter","p","goBack","hideAll","showAddons","breakoutRoomId","room","leave","window","location","href","joinRoom","joinBreakOutRoom","then","res","credential","a","uint32","crypto","getRandomValues","Uint32Array","main","containerId","toString","VideoExpress","Room","sessionId","break","apiKey","applicationId","token","roomContainer","b","roomData","participantName","camera","screen","join","on","isAudioEnabled","isVideoEnabled","breakout","display","signal","isSentByMe","leaveRoom","templateClone","handRaiseTemplate","content","firstElementChild","cloneNode","selectedFeed","querySelector","from","remove","addWebComponent","componentName","vveComponent","append","addWaitingRoomBanner","toggleWaitingRoomBanner","wb","textContent","addWhiteBoardIframe","insertAdjacentHTML","toggleWhiteboardIframe","whiteBoardContainer","we","showWhiteBoard","role","parentSession","loadSkeleton","loadWebComponents","controlContainer","waiting","addMenuItem","title","subTitle","icon","loadAddonsMenu","header","className","createElementDivWithClass","divAddons","whiteboard","breakoutContainer","waitingContainer","addonsContainer","chatContainer","showBreakout","showWaiting","hideWhiteBoard","getWhiteBoardParticipantCredentials","participantToken","participantCredentials","participantsTokens","url","whiteBoardIframe","src","getWhiteBoardAdminCredentials","adminCredentials","ownerToken","openBreakoutRoom","createRoom","attachEvents","addonsBreakoutButton","addonsWaitingButton","addonsWhiteBoardButton","breakoutMsg","breakoutButton","addEventListener","gbw","_participant","participantLeft","participant","connection","connectionId","joinMainRoom","parse","rc","innerHTML","brkroom","event","OT","initSession","parent","updateParticipantId","target","connect","error","message","bind","allowParticipant","dismissParticipant","attachSessionEvents","group","pathname","split","params","URLSearchParams","search","get","groupEnd","onError","setProxyUrl","proxyUrl"],"mappings":"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"}